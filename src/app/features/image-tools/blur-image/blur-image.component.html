<div class="min-h-screen bg-gray-50">
    <!-- Header -->
    <div class="py-12 text-center" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
        <div class="w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-4">
            <i class="fa-solid fa-eye-low-vision text-3xl text-white"></i>
        </div>
        <h1 class="text-3xl font-bold text-white mb-2">Blur Image</h1>
        <p class="text-white/80">Add blur effects to your images</p>
    </div>

    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">

            <!-- Upload Area -->
            @if (!originalImage) {
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-purple-500 hover:bg-purple-50 transition-colors cursor-pointer"
                    (click)="fileInput.click()" (dragover)="onDragOver($event)" (drop)="onDrop($event)">
                    <input #fileInput type="file" accept="image/*" (change)="onFileSelect($event)" class="hidden">
                    <i class="fa-solid fa-cloud-arrow-up text-4xl text-gray-400 mb-3"></i>
                    <p class="text-gray-600 font-medium">Click to upload image</p>
                    <p class="text-gray-400 text-sm mt-1">Supports JPG, PNG, WebP</p>
                </div>
            </div>
            }

            <!-- Editor -->
            @if (originalImage) {
            <div class="grid lg:grid-cols-2 gap-6">

                <!-- Preview -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="font-bold text-gray-800 mb-4">
                        <i class="fa-solid fa-eye text-purple-500 mr-2"></i>Preview
                    </h3>
                    <div class="bg-gray-100 rounded-lg overflow-hidden">
                        <img [src]="resultImage || originalImage" class="w-full h-auto max-h-96 object-contain">
                    </div>
                    <p class="text-xs text-gray-400 mt-2 text-center">{{ originalFileName }}</p>
                </div>

                <!-- Settings -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="font-bold text-gray-800 mb-4">
                        <i class="fa-solid fa-sliders text-purple-500 mr-2"></i>Blur Settings
                    </h3>

                    <!-- Blur Type Selector -->
                    <div class="grid grid-cols-2 gap-2 mb-6">
                        <button (click)="blurType = 'gaussian'"
                            [class]="blurType === 'gaussian' ? 'py-3 px-4 rounded-lg font-medium bg-purple-500 text-white' : 'py-3 px-4 rounded-lg font-medium bg-gray-100 text-gray-600 hover:bg-gray-200'">
                            <i class="fa-solid fa-circle-dot mr-2"></i>Gaussian
                        </button>
                        <button (click)="blurType = 'motion'"
                            [class]="blurType === 'motion' ? 'py-3 px-4 rounded-lg font-medium bg-purple-500 text-white' : 'py-3 px-4 rounded-lg font-medium bg-gray-100 text-gray-600 hover:bg-gray-200'">
                            <i class="fa-solid fa-arrow-right mr-2"></i>Motion
                        </button>
                        <button (click)="blurType = 'radial'"
                            [class]="blurType === 'radial' ? 'py-3 px-4 rounded-lg font-medium bg-purple-500 text-white' : 'py-3 px-4 rounded-lg font-medium bg-gray-100 text-gray-600 hover:bg-gray-200'">
                            <i class="fa-solid fa-bullseye mr-2"></i>Radial
                        </button>
                        <button (click)="blurType = 'pixelate'"
                            [class]="blurType === 'pixelate' ? 'py-3 px-4 rounded-lg font-medium bg-purple-500 text-white' : 'py-3 px-4 rounded-lg font-medium bg-gray-100 text-gray-600 hover:bg-gray-200'">
                            <i class="fa-solid fa-table-cells mr-2"></i>Pixelate
                        </button>
                    </div>

                    <!-- Common Settings -->
                    <div class="space-y-4">
                        @if (blurType !== 'pixelate') {
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                Blur Intensity: {{ blurIntensity }}
                            </label>
                            <input type="range" [(ngModel)]="blurIntensity" min="1" max="50"
                                class="w-full accent-purple-500">
                        </div>
                        }

                        <!-- Motion Blur Options -->
                        @if (blurType === 'motion') {
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                Motion Angle: {{ motionAngle }}Â°
                            </label>
                            <input type="range" [(ngModel)]="motionAngle" min="0" max="360"
                                class="w-full accent-purple-500">
                        </div>
                        }

                        <!-- Radial Blur Options -->
                        @if (blurType === 'radial') {
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Center X: {{ radialCenterX
                                    }}%</label>
                                <input type="range" [(ngModel)]="radialCenterX" min="0" max="100"
                                    class="w-full accent-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Center Y: {{ radialCenterY
                                    }}%</label>
                                <input type="range" [(ngModel)]="radialCenterY" min="0" max="100"
                                    class="w-full accent-purple-500">
                            </div>
                        </div>
                        }

                        <!-- Pixelate Options -->
                        @if (blurType === 'pixelate') {
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                Pixel Size: {{ pixelSize }}px
                            </label>
                            <input type="range" [(ngModel)]="pixelSize" min="2" max="50"
                                class="w-full accent-purple-500">
                        </div>
                        }
                    </div>

                    <!-- Blur Type Info -->
                    <div class="mt-4 p-3 bg-purple-50 rounded-lg text-sm text-purple-800">
                        @if (blurType === 'gaussian') {
                        <i class="fa-solid fa-circle-info mr-2"></i>Gaussian blur creates a smooth, soft blur effect.
                        } @else if (blurType === 'motion') {
                        <i class="fa-solid fa-circle-info mr-2"></i>Motion blur simulates camera movement in a
                        direction.
                        } @else if (blurType === 'radial') {
                        <i class="fa-solid fa-circle-info mr-2"></i>Radial blur creates a zoom-like effect from a center
                        point.
                        } @else if (blurType === 'pixelate') {
                        <i class="fa-solid fa-circle-info mr-2"></i>Pixelate creates a mosaic effect with larger pixels.
                        }
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-6 space-y-3">
                        <button (click)="applyBlur()" [disabled]="isProcessing"
                            class="w-full py-3 bg-purple-500 text-white rounded-lg font-bold hover:bg-purple-600 transition-colors disabled:opacity-50">
                            @if (isProcessing) {
                            <i class="fa-solid fa-spinner fa-spin mr-2"></i>Applying...
                            } @else {
                            <i class="fa-solid fa-eye-low-vision mr-2"></i>Apply Blur
                            }
                        </button>

                        @if (resultImage) {
                        <div class="flex flex-col md:flex-row gap-3">
                            <button (click)="downloadResult()"
                                class="flex-1 py-3 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600 transition-colors">
                                <i class="fa-solid fa-download mr-2"></i>Download
                            </button>
                            <div class="w-full md:w-auto md:flex-1">
                                <app-send-to-tool [hasOutput]="!!resultImage" [currentRoute]="currentRoute"
                                    [outputData]="resultImage" [fileName]="getOutputFileName()" [fileType]="'image'">
                                </app-send-to-tool>
                            </div>
                        </div>
                        }

                        <button (click)="reset()" class="w-full py-2 text-gray-500 hover:text-gray-700 font-medium">
                            <i class="fa-solid fa-rotate mr-2"></i>Start Over
                        </button>
                    </div>
                </div>
            </div>
            }

        </div>
    </div>
</div>