<div class="min-h-screen bg-gray-50">
    <!-- Header -->
    <div class="py-12 text-center" style="background-color: #DBEAFE;">
        <div class="w-16 h-16 bg-white/40 rounded-2xl flex items-center justify-center mx-auto mb-4">
            <i class="fa-solid fa-compress text-3xl" style="color: #3B82F6;"></i>
        </div>
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Image Compressor</h1>
        <p class="text-gray-600">Compress your images while maintaining quality</p>
    </div>

    <div class="container mx-auto px-4 max-w-5xl py-12">
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
            <div class="p-8 md:p-12">
                <div class="border-3 border-dashed border-gray-200 rounded-2xl p-10 text-center transition-all duration-300 hover:border-blue-400 hover:bg-blue-50/50 cursor-pointer"
                    (dragover)="onDragOver($event)" (dragleave)="onDragLeave($event)" (drop)="onDrop($event)"
                    (click)="fileInput.click()">
                    <input #fileInput type="file" multiple accept="image/*" class="hidden"
                        (change)="onFileSelected($event)">
                    <div class="flex flex-col items-center justify-center space-y-4">
                        <div
                            class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center text-blue-500 mb-2">
                            <i class="fa-solid fa-compress text-3xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800">Drag & Drop files here</h3>
                        <p class="text-gray-500">or <span class="text-blue-500 font-semibold hover:underline">browse
                                files</span> from your computer</p>
                        <p class="text-xs text-gray-400 mt-2">Supports all image formats</p>
                    </div>
                </div>

                <!-- Quality Slider & Action Bar - only show after files selected -->
                @if (files.length > 0) {
                <div class="mt-6 bg-blue-50 border border-blue-100 rounded-xl p-4">
                    <div class="flex justify-between items-end mb-2">
                        <label class="font-bold text-gray-700">Quality Level</label>
                        <span class="text-xs font-bold px-2 py-1 rounded bg-white text-blue-600 border border-blue-100">
                            {{ quality }}%
                        </span>
                    </div>

                    <!-- Range Slider -->
                    <div class="relative mb-4">
                        <input type="range" [(ngModel)]="quality" min="10" max="100" step="5"
                            class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500">

                        <div class="flex justify-between text-xs text-gray-500 mt-2 font-medium">
                            <span>Smallest Size</span>
                            <span>Original Quality</span>
                        </div>
                    </div>

                    <!-- Size Estimation -->
                    <div class="flex items-center justify-between pt-3 border-t border-blue-100">
                        <span class="text-sm text-gray-600">Estimated Size:</span>
                        <div class="flex flex-col items-end">
                            <span class="font-bold text-gray-800 text-lg">{{ formatSize(estimatedTotalSize) }}</span>
                            <span class="text-[10px] text-green-600 font-bold bg-green-100 px-1.5 py-0.5 rounded-full">
                                New Size
                            </span>
                        </div>
                    </div>
                </div>
                <div
                    class="mt-4 flex flex-col sm:flex-row justify-between items-center gap-4 bg-gray-50 p-4 rounded-xl border border-gray-100">
                    <div class="text-gray-600 font-medium">
                        <span class="text-gray-900 font-bold">{{ files.length }}</span> files selected
                        @if (allDone) {
                        <span class="ml-2 text-green-600 font-bold">• Saved {{ formatSize(totalSaved) }}</span>
                        }
                    </div>
                    <div class="flex gap-3">
                        <button (click)="clearAll()"
                            class="px-5 py-2.5 rounded-lg text-red-500 font-medium hover:bg-red-50 transition-colors">Clear
                            All</button>
                        <button (click)="compressAll()" [disabled]="isCompressing || allDone"
                            class="px-6 py-2.5 bg-blue-600 text-white rounded-lg font-bold shadow-lg shadow-blue-200 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all">
                            {{ isCompressing ? 'Compressing...' : (allDone ? 'Compressed!' : 'Compress Images') }}
                        </button>
                    </div>
                </div>
                }

                @if (isCompressing) {
                <div class="mt-6">
                    <div class="flex justify-between text-sm font-medium text-gray-600 mb-2">
                        <span>Compressing...</span><span>{{ progress }}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5 overflow-hidden">
                        <div class="bg-blue-600 h-2.5 rounded-full transition-all duration-300"
                            [style.width.%]="progress">
                        </div>
                    </div>
                </div>
                }

                @if (allDone) {
                <div class="mt-6 flex flex-col md:flex-row items-center justify-center gap-4">
                    @if (files.length > 1) {
                    <button (click)="downloadAll()"
                        class="flex-1 w-full md:w-auto inline-flex items-center justify-center gap-2 px-8 py-3 bg-green-500 text-white rounded-xl font-bold text-lg shadow-lg shadow-green-200 hover:bg-green-600 transition-all">
                        <i class="fa-solid fa-download"></i> Download All Files
                    </button>
                    }

                    <!-- Send to Tool (first compressed image) - Always show when done -->
                    <div class="w-full md:w-auto md:flex-1">
                        <app-send-to-tool [hasOutput]="!!firstCompressedImage" [currentRoute]="currentRoute"
                            [outputData]="firstCompressedImage || ''" [fileName]="firstFileName" [fileType]="'image'">
                        </app-send-to-tool>
                    </div>
                </div>
                }

                @if (files.length > 0) {
                <div class="mt-10 grid grid-cols-1 md:grid-cols-2 gap-6">
                    @for (file of files; track file.id) {
                    <div
                        class="group relative bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all overflow-hidden">
                        <div class="flex gap-4 p-4">
                            <div class="w-24 h-24 flex-shrink-0 bg-gray-100 rounded-lg overflow-hidden relative">
                                <img [src]="file.compressedUrl || file.previewUrl" class="w-full h-full object-cover"
                                    alt="preview">
                                @if (file.status === 'compressing') {
                                <div
                                    class="absolute inset-0 bg-black/50 flex items-center justify-center backdrop-blur-sm">
                                    <i class="fa-solid fa-circle-notch fa-spin text-white text-xl"></i>
                                </div>
                                }
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="font-medium text-gray-800 truncate mb-2">{{ file.name }}</p>
                                <div class="text-sm text-gray-500 space-y-1">
                                    <p>Original: <span class="text-gray-700 font-medium">{{
                                            formatSize(file.originalSize) }}</span></p>
                                    @if (file.status === 'done') {
                                    <p>Compressed: <span class="text-green-600 font-bold">{{
                                            formatSize(file.compressedSize) }}</span></p>
                                    <p class="text-green-600 font-bold">↓ {{ getSavingsPercent(file) }}% smaller</p>
                                    }
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                @if (file.status === 'done') {
                                <button (click)="downloadOne(file)"
                                    class="px-4 py-2 bg-gray-900 text-white rounded-lg font-medium hover:bg-gray-800 transition-colors flex items-center gap-2 text-sm">
                                    <i class="fa-solid fa-download"></i> Download
                                </button>
                                }
                                <button (click)="removeFile(file.id)"
                                    class="px-4 py-2 text-red-500 rounded-lg hover:bg-red-50 transition-colors flex items-center justify-center">
                                    <i class="fa-solid fa-xmark"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    }
                </div>
                }
            </div>
        </div>

        <!-- SEO Content -->
        <article class="prose lg:prose-xl mx-auto mt-16 px-4 max-w-4xl">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">Compress Images Online — Smaller Files, Same Quality</h2>
            <p class="text-gray-600 mb-8 leading-relaxed">
                A 5 MB photo from your phone looks great, but it's a pain to email, slows down your website, and eats
                through storage fast. The frustrating part? Most of that file size is data your eyes can't even
                distinguish. This compressor strips out the redundant stuff and keeps what actually matters visually —
                saving you 50–80% on file size while the image still looks essentially the same.
            </p>
            <p class="text-gray-600 mb-8 leading-relaxed">
                If you run a website or blog, image compression isn't optional anymore. Google's Core Web Vitals
                directly factor in how fast your images load, and unoptimized photos are the single biggest cause of
                slow page speeds. Compressing before you upload can be the difference between a green score and a red
                one. The same applies to emails — most providers cap attachments around 25 MB, so shrinking photos means
                you can actually attach a full album instead of just two or three shots.
            </p>

            <h2 class="text-2xl font-bold text-gray-800 mb-4">How the Quality Slider Works</h2>
            <p class="text-gray-600 mb-8 leading-relaxed">
                You get a slider from 10% to 100%. At 100%, the image stays untouched. At lower settings, the compressor
                discards more visual data to shrink the file further. For most people, somewhere between 60-80% is the
                sweet spot — you'll see a big drop in file size with virtually no visible difference. Below 40%,
                compression artifacts start becoming noticeable, especially in areas with gradients or fine detail. The
                tool shows you the estimated file size before you commit, so you can experiment without guessing.
            </p>

            <h2 class="text-2xl font-bold text-gray-800 mb-4">Batch Processing and Privacy</h2>
            <p class="text-gray-600 mb-8 leading-relaxed">
                You can throw in as many images as you want — no file count limit. They all compress at once, and you
                can download each one individually or grab everything together. The entire process runs in your browser,
                so your photos never get uploaded to a server. That's not marketing fluff — it's how the Canvas API
                works. Your files stay on your machine the whole time.
            </p>

            <h2 class="text-2xl font-bold text-gray-800 mb-4">Frequently Asked Questions</h2>
            <div class="space-y-4">
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                    <h3 class="font-bold text-gray-900 mb-2">Will I actually see a quality difference?</h3>
                    <p class="text-gray-600">At 60% quality and above, most people genuinely can't tell the difference —
                        you'd have to zoom in and compare pixel-by-pixel. Start around 75% and see if it looks good to
                        you. If it does, you're saving a massive amount of space for basically zero visual cost.</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                    <h3 class="font-bold text-gray-900 mb-2">How much smaller will my files get?</h3>
                    <p class="text-gray-600">It depends on the image content and your quality setting. Photos with lots
                        of detail and color variation compress really well — expect 60–80% reduction. Flat graphics and
                        screenshots compress less aggressively, more like 30–50%. Either way, it's significant.</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                    <h3 class="font-bold text-gray-900 mb-2">Does this change my image's resolution or dimensions?</h3>
                    <p class="text-gray-600">No. Compression only affects how the pixel data is stored — it doesn't
                        resize anything. Your image keeps the exact same width, height, and pixel count. Only the file
                        size changes.</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                    <h3 class="font-bold text-gray-900 mb-2">What formats are supported?</h3>
                    <p class="text-gray-600">JPG, PNG, and WebP. The output stays in whatever format the original was,
                        so you don't need to worry about compatibility issues after compressing.</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                    <h3 class="font-bold text-gray-900 mb-2">Is there a limit on how many images I can compress?</h3>
                    <p class="text-gray-600">No limits at all — no file count cap, no total size restriction, no daily
                        quota. It's completely free and unlimited. Compress 5 images or 500, same deal.</p>
                </div>
            </div>
        </article>
    </div>
</div>