<div class="min-h-screen bg-gray-50">
    <div class="bg-gradient-to-r from-orange-500 to-amber-500 py-12">
        <div class="container mx-auto px-4 text-center">
            <div class="w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-4">
                <i class="fa-solid fa-file-code text-2xl text-white"></i>
            </div>
            <h1 class="text-3xl font-bold text-white mb-2">Excel to JSON</h1>
            <p class="text-orange-100">Convert Excel/CSV data to JSON format</p>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Left: Input -->
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                        <i class="fa-solid fa-file-excel text-orange-500"></i>
                        Input
                    </h3>
                    <!-- Input Mode Toggle -->
                    <div class="bg-gray-100 rounded-lg p-0.5 inline-flex text-sm">
                        <button (click)="inputMode = 'file'; reset()" [class.bg-white]="inputMode === 'file'"
                            [class.shadow-sm]="inputMode === 'file'" [class.text-gray-800]="inputMode === 'file'"
                            [class.text-gray-500]="inputMode !== 'file'"
                            class="px-3 py-1.5 rounded-md font-medium transition-all">
                            <i class="fa-solid fa-upload mr-1"></i>File
                        </button>
                        <button (click)="inputMode = 'text'; reset()" [class.bg-white]="inputMode === 'text'"
                            [class.shadow-sm]="inputMode === 'text'" [class.text-gray-800]="inputMode === 'text'"
                            [class.text-gray-500]="inputMode !== 'text'"
                            class="px-3 py-1.5 rounded-md font-medium transition-all">
                            <i class="fa-solid fa-keyboard mr-1"></i>Text
                        </button>
                    </div>
                </div>

                @if (inputMode === 'file') {
                @if (!selectedFile) {
                <div class="upload-area border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-all h-64 flex flex-col items-center justify-center"
                    [class.border-orange-400]="isDragging" [class.bg-orange-50]="isDragging"
                    [class.border-gray-300]="!isDragging" (dragover)="onDragOver($event)"
                    (dragleave)="onDragLeave($event)" (drop)="onDrop($event)" (click)="fileInput.click()">
                    <input #fileInput type="file" accept=".xlsx,.xls,.csv" class="hidden"
                        (change)="onFileSelected($event)">
                    <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-3">
                        <i class="fa-solid fa-cloud-arrow-up text-2xl text-orange-500"></i>
                    </div>
                    <h4 class="font-medium text-gray-700 mb-1">Drop Excel/CSV file here</h4>
                    <p class="text-sm text-gray-500">or click to browse</p>
                </div>
                } @else {
                <div class="border rounded-xl p-4 bg-gray-50">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-file-excel text-orange-500"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="font-medium text-gray-800 truncate">{{ selectedFile.name }}</p>
                            <p class="text-sm text-gray-500">{{ formatFileSize(selectedFile.size) }}</p>
                        </div>
                        <button (click)="reset()" class="text-gray-400 hover:text-gray-600">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    </div>
                </div>

                @if (sheets.length > 1) {
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Select Sheet</label>
                    <div class="flex flex-wrap gap-2">
                        @for (sheet of sheets; track sheet) {
                        <button (click)="onSheetChange(sheet)" [class.bg-orange-500]="selectedSheet === sheet"
                            [class.text-white]="selectedSheet === sheet" [class.bg-gray-100]="selectedSheet !== sheet"
                            [class.text-gray-700]="selectedSheet !== sheet"
                            class="px-3 py-1.5 rounded-lg text-sm font-medium transition-colors">
                            {{ sheet }}
                        </button>
                        }
                    </div>
                </div>
                }
                }
                } @else {
                <textarea [(ngModel)]="inputText" rows="10"
                    class="w-full border border-gray-300 rounded-xl p-4 font-mono text-sm focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none"
                    placeholder="Paste CSV or tab-separated data here:&#10;&#10;name,email,age&#10;John Doe,john@example.com,30&#10;Jane Smith,jane@example.com,25"></textarea>

                @if (!jsonData) {
                <button (click)="processText()" [disabled]="!inputText.trim()"
                    class="w-full mt-4 bg-gradient-to-r from-orange-500 to-amber-500 text-white py-3 rounded-xl font-semibold hover:opacity-90 transition-opacity flex items-center justify-center gap-2 disabled:opacity-50">
                    <i class="fa-solid fa-arrow-right"></i>
                    Convert to JSON
                </button>
                }
                }

                @if (jsonData) {
                <div class="flex gap-3 mt-4">
                    <button (click)="download()"
                        class="flex-1 bg-gradient-to-r from-orange-500 to-amber-500 text-white py-3 rounded-xl font-semibold hover:opacity-90 transition-opacity flex items-center justify-center gap-2">
                        <i class="fa-solid fa-download"></i>
                        Download JSON
                    </button>
                    <button (click)="reset()"
                        class="bg-gray-100 text-gray-700 px-4 py-3 rounded-xl font-medium hover:bg-gray-200 transition-colors">
                        Reset
                    </button>
                </div>
                }
            </div>

            <!-- Right: Output -->
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                        <i class="fa-solid fa-code text-orange-500"></i>
                        Output
                        @if (jsonData) {
                        <span class="text-sm font-normal text-gray-500">({{ jsonData.length }} records)</span>
                        }
                    </h3>
                    @if (jsonString) {
                    <button (click)="copyToClipboard()"
                        class="text-sm text-orange-500 hover:text-orange-600 flex items-center gap-1">
                        <i class="fa-solid fa-copy"></i> Copy
                    </button>
                    }
                </div>

                @if (!jsonData) {
                <div class="h-80 flex items-center justify-center border-2 border-dashed border-gray-200 rounded-xl">
                    <div class="text-center text-gray-400">
                        <i class="fa-solid fa-file-code text-4xl mb-3"></i>
                        <p>JSON output will appear here</p>
                    </div>
                </div>
                } @else {
                <pre
                    class="bg-gray-900 text-green-400 p-4 rounded-xl overflow-auto h-80 text-sm font-mono">{{ jsonString }}</pre>
                }
            </div>
        </div>

        @if (error) {
        <div class="mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl">{{ error }}</div>
        }
    </div>

    <!-- SEO Content Section -->
    <div class="container mx-auto px-4 py-12 max-w-5xl">
        <div class="prose prose-lg max-w-none">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Excel to JSON — Turn Spreadsheets into Something Your Code
                Can Use</h2>
            <p class="text-gray-600 mb-8">Your PM handed you an Excel file. Your app needs JSON. This tool bridges that
                gap in about two seconds. Headers become keys, rows become objects, and you get an array you can paste
                straight into your project or feed to an API.</p>

            <!-- How to Steps -->
            <div class="bg-white rounded-xl p-6 shadow-sm mb-8">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Dead Simple</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center p-4 border border-gray-100 rounded-xl">
                        <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <span class="text-orange-600 font-bold text-lg">1</span>
                        </div>
                        <h4 class="font-medium text-gray-800 mb-2">Drop Your File</h4>
                        <p class="text-gray-500 text-sm">XLSX, XLS, or CSV — drag it in or paste the data directly</p>
                    </div>
                    <div class="text-center p-4 border border-gray-100 rounded-xl">
                        <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <span class="text-orange-600 font-bold text-lg">2</span>
                        </div>
                        <h4 class="font-medium text-gray-800 mb-2">Pick Your Sheet</h4>
                        <p class="text-gray-500 text-sm">Multiple worksheets? Select the one with the data you want</p>
                    </div>
                    <div class="text-center p-4 border border-gray-100 rounded-xl">
                        <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <span class="text-orange-600 font-bold text-lg">3</span>
                        </div>
                        <h4 class="font-medium text-gray-800 mb-2">Copy or Download</h4>
                        <p class="text-gray-500 text-sm">Grab the formatted JSON — copy to clipboard or save as a file
                        </p>
                    </div>
                </div>
            </div>

            <!-- Features Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-code text-orange-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Clean, Readable Output</h4>
                    <p class="text-gray-500 text-sm">Properly indented JSON you can actually read — not a giant
                        compressed blob.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-table-cells text-orange-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Handles Multiple Sheets</h4>
                    <p class="text-gray-500 text-sm">Workbook has 15 tabs? Pick whichever one you need.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-copy text-orange-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">One-Click Copy</h4>
                    <p class="text-gray-500 text-sm">Hit copy, paste into VS Code. Done.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-server text-orange-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Ready for Your Stack</h4>
                    <p class="text-gray-500 text-sm">Output works with REST APIs, MongoDB, Firebase, or any JS
                        framework.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-bolt text-orange-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Fast — Like, Actually Fast</h4>
                    <p class="text-gray-500 text-sm">Runs in your browser, no server round-trip. Big files convert in
                        seconds.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-shield-halved text-orange-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Nothing Leaves Your Machine</h4>
                    <p class="text-gray-500 text-sm">All processing happens locally. No upload, no server, no tracking.
                    </p>
                </div>
            </div>

            <!-- Use Cases -->
            <div class="bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl p-6 mb-8">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">
                    <i class="fa-solid fa-lightbulb text-orange-500 mr-2"></i>Real-World Scenarios
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check-circle text-orange-500 mt-0.5"></i>
                        <span class="text-gray-600"><strong>Frontend Dev:</strong> Need test data for React, Vue, or
                            Angular? Convert that spreadsheet to JSON and import it</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check-circle text-orange-500 mt-0.5"></i>
                        <span class="text-gray-600"><strong>API Seeding:</strong> Populate your endpoints with real data
                            from spreadsheets during development</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check-circle text-orange-500 mt-0.5"></i>
                        <span class="text-gray-600"><strong>NoSQL Databases:</strong> MongoDB insertMany(), Firestore
                            batch writes — just paste the array</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check-circle text-orange-500 mt-0.5"></i>
                        <span class="text-gray-600"><strong>Config Files:</strong> Turn a settings spreadsheet into a
                            JSON config your app can read</span>
                    </div>
                </div>
            </div>

            <!-- FAQ Section -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">
                    <i class="fa-solid fa-circle-question text-orange-500 mr-2"></i>Developer Questions
                </h3>
                <div class="space-y-4">
                    <details class="group border-b border-gray-100 pb-4">
                        <summary class="font-medium text-gray-700 cursor-pointer flex justify-between items-center">
                            What does the output look like?
                            <i
                                class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <p class="mt-3 text-gray-600 text-sm">You get an array of objects. Each row is one object, and
                            the column headers become the keys. So a spreadsheet with "name" and "email" columns gives
                            you objects like name: "Alice", email: "alice&#64;example.com" for each row. Pretty standard
                            stuff.</p>
                    </details>
                    <details class="group border-b border-gray-100 pb-4">
                        <summary class="font-medium text-gray-700 cursor-pointer flex justify-between items-center">
                            Can I use this directly with MongoDB?
                            <i
                                class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <p class="mt-3 text-gray-600 text-sm">Yep. The output is a JSON array that works with
                            db.collection.insertMany() or you can import it through MongoDB Compass. No reformatting
                            needed.</p>
                    </details>
                    <details class="group border-b border-gray-100 pb-4">
                        <summary class="font-medium text-gray-700 cursor-pointer flex justify-between items-center">
                            What happens with blank cells?
                            <i
                                class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <p class="mt-3 text-gray-600 text-sm">Empty cells become empty strings in the JSON. The key is
                            still there, so your data structure stays consistent across all rows. No missing keys to
                            break your code.</p>
                    </details>
                    <details class="group pb-4">
                        <summary class="font-medium text-gray-700 cursor-pointer flex justify-between items-center">
                            Does it keep numbers as numbers (not strings)?
                            <i
                                class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <p class="mt-3 text-gray-600 text-sm">Yes — 42 stays as 42, not "42". Text stays as strings, and
                            dates get converted to a readable format. The converter is smart about data types so you
                            don't have to parseInt() everything.</p>
                    </details>
                </div>
            </div>
        </div>
    </div>
</div>