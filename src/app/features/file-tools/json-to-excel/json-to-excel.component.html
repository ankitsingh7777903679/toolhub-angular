<div class="min-h-screen bg-gray-50">
    <div class="bg-gradient-to-r from-violet-500 to-purple-500 py-12">
        <div class="container mx-auto px-4 text-center">
            <div class="w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-4">
                <i class="fa-solid fa-table text-2xl text-white"></i>
            </div>
            <h1 class="text-3xl font-bold text-white mb-2">JSON to Excel</h1>
            <p class="text-violet-100">Convert JSON data to Excel spreadsheets</p>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Left: Input -->
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                        <i class="fa-solid fa-file-code text-violet-500"></i>
                        Input
                    </h3>
                    <!-- Input Mode Toggle -->
                    <div class="bg-gray-100 rounded-lg p-0.5 inline-flex text-sm">
                        <button (click)="inputMode = 'file'; reset()" [class.bg-white]="inputMode === 'file'"
                            [class.shadow-sm]="inputMode === 'file'" [class.text-gray-800]="inputMode === 'file'"
                            [class.text-gray-500]="inputMode !== 'file'"
                            class="px-3 py-1.5 rounded-md font-medium transition-all">
                            <i class="fa-solid fa-upload mr-1"></i>File
                        </button>
                        <button (click)="inputMode = 'text'; reset()" [class.bg-white]="inputMode === 'text'"
                            [class.shadow-sm]="inputMode === 'text'" [class.text-gray-800]="inputMode === 'text'"
                            [class.text-gray-500]="inputMode !== 'text'"
                            class="px-3 py-1.5 rounded-md font-medium transition-all">
                            <i class="fa-solid fa-keyboard mr-1"></i>Text
                        </button>
                    </div>
                </div>

                @if (inputMode === 'file') {
                @if (!selectedFile) {
                <div class="upload-area border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-all h-64 flex flex-col items-center justify-center"
                    [class.border-violet-400]="isDragging" [class.bg-violet-50]="isDragging"
                    [class.border-gray-300]="!isDragging" (dragover)="onDragOver($event)"
                    (dragleave)="onDragLeave($event)" (drop)="onDrop($event)" (click)="fileInput.click()">
                    <input #fileInput type="file" accept=".json" class="hidden" (change)="onFileSelected($event)">
                    <div class="w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center mb-3">
                        <i class="fa-solid fa-cloud-arrow-up text-2xl text-violet-500"></i>
                    </div>
                    <h4 class="font-medium text-gray-700 mb-1">Drop JSON file here</h4>
                    <p class="text-sm text-gray-500">or click to browse</p>
                </div>
                } @else {
                <div class="border rounded-xl p-4 bg-gray-50">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-violet-100 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-file-code text-violet-500"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="font-medium text-gray-800 truncate">{{ selectedFile.name }}</p>
                            <p class="text-sm text-gray-500">{{ formatFileSize(selectedFile.size) }} • {{
                                jsonData?.length || 0 }} records</p>
                        </div>
                        <button (click)="reset()" class="text-gray-400 hover:text-gray-600">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    </div>
                </div>
                }
                } @else {
                <textarea [(ngModel)]="jsonText" rows="10"
                    class="w-full border border-gray-300 rounded-xl p-4 font-mono text-sm focus:ring-2 focus:ring-violet-500 focus:border-violet-500 resize-none"
                    placeholder='[
  {"name": "John Doe", "email": "john@example.com", "age": 30},
  {"name": "Jane Smith", "email": "jane@example.com", "age": 25}
]'></textarea>

                @if (!isReady) {
                <button (click)="processText()" [disabled]="!jsonText.trim()"
                    class="w-full mt-4 bg-gradient-to-r from-violet-500 to-purple-500 text-white py-3 rounded-xl font-semibold hover:opacity-90 transition-opacity flex items-center justify-center gap-2 disabled:opacity-50">
                    <i class="fa-solid fa-arrow-right"></i>
                    Convert to Excel
                </button>
                }
                }

                @if (isReady) {
                <div class="flex gap-3 mt-4">
                    <button (click)="download()"
                        class="flex-1 bg-gradient-to-r from-violet-500 to-purple-500 text-white py-3 rounded-xl font-semibold hover:opacity-90 transition-opacity flex items-center justify-center gap-2">
                        <i class="fa-solid fa-download"></i>
                        Download Excel
                    </button>
                    <button (click)="reset()"
                        class="bg-gray-100 text-gray-700 px-4 py-3 rounded-xl font-medium hover:bg-gray-200 transition-colors">
                        Reset
                    </button>
                </div>
                }
            </div>

            <!-- Right: Output -->
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2 mb-4">
                    <i class="fa-solid fa-table text-violet-500"></i>
                    Output Preview
                    @if (jsonData) {
                    <span class="text-sm font-normal text-gray-500">({{ previewRows.length }} of {{ jsonData.length }}
                        rows)</span>
                    }
                </h3>

                @if (!jsonData || previewRows.length === 0) {
                <div class="h-80 flex items-center justify-center border-2 border-dashed border-gray-200 rounded-xl">
                    <div class="text-center text-gray-400">
                        <i class="fa-solid fa-table text-4xl mb-3"></i>
                        <p>Table preview will appear here</p>
                    </div>
                </div>
                } @else {
                <div class="overflow-x-auto border rounded-xl h-80">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-violet-50 sticky top-0">
                            <tr>
                                @for (header of headers; track header) {
                                <th
                                    class="px-4 py-2 text-left text-sm font-semibold text-gray-700 border-r last:border-r-0 whitespace-nowrap">
                                    {{ header }}
                                </th>
                                }
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            @for (row of previewRows; track $index) {
                            <tr>
                                @for (header of headers; track header) {
                                <td
                                    class="px-4 py-2 text-sm text-gray-700 border-r last:border-r-0 whitespace-nowrap max-w-xs truncate">
                                    {{ getCellValue(row, header) }}
                                </td>
                                }
                            </tr>
                            }
                        </tbody>
                    </table>
                </div>
                }
            </div>
        </div>

        @if (error) {
        <div class="mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl">{{ error }}</div>
        }
    </div>

    <!-- SEO Content Section -->
    <div class="container mx-auto px-4 py-12 max-w-5xl">
        <div class="prose prose-lg max-w-none">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">JSON to Excel — Make API Data Look Like a Normal
                Spreadsheet</h2>
            <p class="text-gray-600 mb-8">Your boss doesn't read JSON. Your client definitely doesn't. Paste your API
                response or upload a JSON file and you'll get a clean Excel spreadsheet that anyone can open, filter,
                and understand. Keys become columns, values become rows. Simple.</p>

            <!-- How to Steps -->
            <div class="bg-white rounded-xl p-6 shadow-sm mb-8">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Paste, Preview, Download</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center p-4 border border-gray-100 rounded-xl">
                        <div class="w-12 h-12 bg-violet-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <span class="text-violet-600 font-bold text-lg">1</span>
                        </div>
                        <h4 class="font-medium text-gray-800 mb-2">Paste or Upload JSON</h4>
                        <p class="text-gray-500 text-sm">Copy from Postman, your terminal, or wherever — paste it right
                            in</p>
                    </div>
                    <div class="text-center p-4 border border-gray-100 rounded-xl">
                        <div class="w-12 h-12 bg-violet-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <span class="text-violet-600 font-bold text-lg">2</span>
                        </div>
                        <h4 class="font-medium text-gray-800 mb-2">Check the Table</h4>
                        <p class="text-gray-500 text-sm">Preview how your JSON maps to rows and columns before exporting
                        </p>
                    </div>
                    <div class="text-center p-4 border border-gray-100 rounded-xl">
                        <div class="w-12 h-12 bg-violet-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <span class="text-violet-600 font-bold text-lg">3</span>
                        </div>
                        <h4 class="font-medium text-gray-800 mb-2">Grab the Excel File</h4>
                        <p class="text-gray-500 text-sm">Download a .xlsx that opens in Excel, Google Sheets, or Numbers
                        </p>
                    </div>
                </div>
            </div>

            <!-- Features Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-violet-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-layer-group text-violet-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Handles Nested Data</h4>
                    <p class="text-gray-500 text-sm">Got objects inside objects? They get flattened into columns like
                        user.name, address.city.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-violet-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-list text-violet-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Arrays Become Rows</h4>
                    <p class="text-gray-500 text-sm">Each item in your JSON array gets its own row. Exactly what you'd
                        expect.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-violet-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-heading text-violet-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Smart Column Headers</h4>
                    <p class="text-gray-500 text-sm">JSON keys automatically become column names — no manual mapping
                        needed.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-violet-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-eye text-violet-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">See Before You Save</h4>
                    <p class="text-gray-500 text-sm">Preview the table layout so you know the spreadsheet will look
                        right.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-violet-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-check-double text-violet-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Types Stay Intact</h4>
                    <p class="text-gray-500 text-sm">Numbers stay as numbers, not text. Boolean values, dates, strings —
                        all preserved.</p>
                </div>
                <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="w-10 h-10 bg-violet-100 rounded-lg flex items-center justify-center mb-3">
                        <i class="fa-solid fa-lock text-violet-500"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Runs Locally</h4>
                    <p class="text-gray-500 text-sm">Your JSON never gets uploaded. Everything processes in your
                        browser.</p>
                </div>
            </div>

            <!-- Use Cases -->
            <div class="bg-gradient-to-r from-violet-50 to-purple-50 rounded-xl p-6 mb-8">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">
                    <i class="fa-solid fa-lightbulb text-violet-500 mr-2"></i>When This Comes in Handy
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check-circle text-violet-500 mt-0.5"></i>
                        <span class="text-gray-600"><strong>API Debugging:</strong> Paste a response from Postman and
                            see all the data in a table instead of scrolling through JSON</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check-circle text-violet-500 mt-0.5"></i>
                        <span class="text-gray-600"><strong>Sharing Data:</strong> Turn technical JSON into a
                            spreadsheet your team lead or client can actually read</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check-circle text-violet-500 mt-0.5"></i>
                        <span class="text-gray-600"><strong>Database Exports:</strong> Pull data from MongoDB or
                            Firebase and hand it over as a usable spreadsheet</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <i class="fa-solid fa-check-circle text-violet-500 mt-0.5"></i>
                        <span class="text-gray-600"><strong>Quick Analysis:</strong> Filter and sort API data with
                            Excel's built-in tools instead of writing code</span>
                    </div>
                </div>
            </div>

            <!-- FAQ Section -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">
                    <i class="fa-solid fa-circle-question text-violet-500 mr-2"></i>Things You Might Wonder
                </h3>
                <div class="space-y-4">
                    <details class="group border-b border-gray-100 pb-4">
                        <summary class="font-medium text-gray-700 cursor-pointer flex justify-between items-center">
                            What kinds of JSON does it handle?
                            <i
                                class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <p class="mt-3 text-gray-600 text-sm">Arrays of objects (the most common API response format),
                            single objects, and nested structures. If it's valid JSON, it'll convert. If it's deeply
                            nested, the converter flattens it using dot notation.</p>
                    </details>
                    <details class="group border-b border-gray-100 pb-4">
                        <summary class="font-medium text-gray-700 cursor-pointer flex justify-between items-center">
                            What happens with nested objects like user > name > "Alice"?
                            <i
                                class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <p class="mt-3 text-gray-600 text-sm">Nested keys get flattened with dots. So "user.name"
                            becomes
                            a column header with "Alice" as the value. It's the same convention tools like pandas use,
                            so the output should feel familiar.</p>
                    </details>
                    <details class="group border-b border-gray-100 pb-4">
                        <summary class="font-medium text-gray-700 cursor-pointer flex justify-between items-center">
                            Can I paste a Postman response directly?
                            <i
                                class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <p class="mt-3 text-gray-600 text-sm">Yep. Copy the response body from Postman, Insomnia, or
                            your browser's DevTools network tab and paste it in. As long as it's valid JSON, it'll work.
                        </p>
                    </details>
                    <details class="group pb-4">
                        <summary class="font-medium text-gray-700 cursor-pointer flex justify-between items-center">
                            Is there a size limit?
                            <i
                                class="fa-solid fa-chevron-down text-gray-400 group-open:rotate-180 transition-transform"></i>
                        </summary>
                        <p class="mt-3 text-gray-600 text-sm">No server limit since everything runs locally. Most API
                            responses (even large ones) convert instantly. If you're pasting a 20MB JSON dump, it might
                            take a moment, but it'll get there.</p>
                    </details>
                </div>
            </div>
        </div>
    </div>
</div>